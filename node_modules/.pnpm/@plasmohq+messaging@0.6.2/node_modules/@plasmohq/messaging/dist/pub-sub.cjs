var a=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var l=Object.getOwnPropertyNames;var u=Object.prototype.hasOwnProperty;var m=(t,e)=>{for(var n in e)a(t,n,{get:e[n],enumerable:!0})},d=(t,e,n,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of l(e))!u.call(t,r)&&r!==n&&a(t,r,{get:()=>e[r],enumerable:!(o=b(e,r))||o.enumerable});return t};var p=t=>d(a({},"__esModule",{value:!0}),t);var h={};m(h,{broadcast:()=>c,connectToHub:()=>g,getHubMap:()=>i,startHub:()=>x});module.exports=p(h);var y=globalThis.browser?.tabs||globalThis.chrome?.tabs,s=()=>{let t=globalThis.browser?.runtime||globalThis.chrome?.runtime;if(!t)throw new Error("Extension runtime is not available");return t};var i=()=>globalThis.__plasmoInternalHubMap,x=()=>{let t=s();if(!t.onConnectExternal)throw new Error("onConnect External not available. You need externally_connectable entry possibly");globalThis.__plasmoInternalHubMap=new Map;let e=i();t.onConnectExternal.addListener(n=>{let o=n.sender.tab.id;e.has(o)||(e.set(o,n),n.onMessage.addListener(r=>{c({from:o,payload:r})}),n.onDisconnect.addListener(()=>{e.delete(o)}))})},c=t=>{i().forEach((n,o)=>{o!==t.from&&n.postMessage({...t,to:o})})},g=t=>{let e=s();if(!e.connect)throw new Error("runtime.connect not available. You need to use startHub in BGSW");return e.connect(t)};0&&(module.exports={broadcast,connectToHub,getHubMap,startHub});
